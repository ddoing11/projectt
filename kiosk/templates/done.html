{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=1640, user-scalable=no" />
  <title>ì£¼ë¬¸ ì™„ë£Œ</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 1640px;
      height: 2360px;
      background-color: #5c4033;
      overflow: hidden;
    }

    .full-bg {
      width: 100%;
      height: 100%;
      background: url("{% static 'images/end.png' %}") no-repeat center center;
      background-size: cover;
      cursor: pointer;
    }
  </style>
  <script>
    // í˜¸ìŠ¤íŠ¸ ì´ë¦„ì´ localhost/127.0.0.1ì´ë©´ ë¡œì»¬ í¬íŠ¸ 8002ë¡œ ì ‘ì†, ë°°í¬ í™˜ê²½ì—ì„œëŠ” ì›ëž˜ ì£¼ì†Œ ì‚¬ìš©
    const wsUrl =
      window.location.hostname === "127.0.0.1" || window.location.hostname === "localhost"
        ? "ws://127.0.0.1:8002"
        : "wss://6a01-49-143-8-202.ngrok-free.app";

    const socket = new WebSocket(wsUrl);

    socket.onopen = () => {
      console.log("âœ… WebSocket ì—°ê²°ë¨");
      socket.send("done_page_ready");  // ðŸ“¨ ì„œë²„ì— ì¤€ë¹„ ì™„ë£Œ ì•Œë¦¼
    };

    socket.onmessage = (event) => {
      const message = event.data;
      console.log("ðŸ“© ì„œë²„ ì‘ë‹µ:", message);

      // ì„œë²„ê°€ 'say_payment_done' ë©”ì‹œì§€ë¥¼ ë³´ë‚´ëŠ” ê²½ìš° ì²˜ë¦¬
      if (message === "say_payment_done") {
        console.log("ðŸ”Š 'ê²°ì œ ì™„ë£Œ' ìŒì„± ìž¬ìƒ íŠ¸ë¦¬ê±°");
        // í•„ìš”ì‹œ ì—¬ê¸°ì„œ ì• ë‹ˆë©”ì´ì…˜ì´ë‚˜ í™”ë©´ íš¨ê³¼ë¥¼ ì¶”ê°€í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
      }
    };

    // 4.5ì´ˆ ë’¤ì— /startë¡œ ìžë™ ì´ë™
    setTimeout(() => {
      window.location.href = '/start';
    }, 4500);
  </script>
</head>
<body>
  <div class="full-bg"></div>
</body>
</html>
